<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pell">
<title>Download pell data from US Department of Education â€¢ pell</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Download pell data from US Department of Education">
<meta property="og:description" content="pell">
<meta property="og:image" content="https://curious-joe.github.io/pell/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pell</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/intro.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Use pell</h6>
    <a class="dropdown-item" href="../articles/examples.html">Examples using ggplot2</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Extras</h6>
    <a class="dropdown-item" href="../articles/download.html">Download the data directly</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Curious-Joe/pell/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Download pell data from US Department of Education</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Curious-Joe/pell/blob/HEAD/vignettes/download.Rmd" class="external-link"><code>vignettes/download.Rmd</code></a></small>
      <div class="d-none name"><code>download.Rmd</code></div>
    </div>

    
    
<hr>
<div class="section level2">
<h2 id="download-data-from-a-us-department-of-education-website">Download data from a US Department of Education website<a class="anchor" aria-label="anchor" href="#download-data-from-a-us-department-of-education-website"></a>
</h2>
<p>In case you are curious, you can also directly get the data from the website of US Department of Education. The website provides all the data in separate files one for each year. The reporting format is not consistent across the files. So, if you want to derive the dataset by yourself, you will need to do some data cleaning. Which has already been done in the <code>pell</code> package.</p>
<p>You can find the data in this link: <a href="https://www2.ed.gov/finaid/prof/resources/data/pell-institution.html" class="external-link">Pell grant data</a>.</p>
<p>You can use the following code snippet to download all the data without needing to manually click and save the excel files:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 0.1 Loading Libraries ----</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rvest.tidyverse.org/" class="external-link">rvest</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://httr.r-lib.org/" class="external-link">httr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor" class="external-link">janitor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidyverse/glue" class="external-link">glue</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 0.0 Variables ----</span></span>
<span><span class="va">raw_data_loc</span> <span class="op">=</span> <span class="st">"data-raw/yearly-data/"</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://www2.ed.gov/finaid/prof/resources/data/pell-institution.html"</span></span>
<span><span class="va">downloadString</span> <span class="op">&lt;-</span> <span class="st">"https://www2.ed.gov/finaid/prof/resources/data/"</span></span>
<span></span>
<span><span class="co"># 1.0 DATA SOURCING ----</span></span>
<span></span>
<span><span class="co"># 1.1 Web Scraping ----</span></span>
<span><span class="va">htmlOutput</span> <span class="op">&lt;-</span> <span class="fu">read_html</span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># collect years</span></span>
<span><span class="va">years</span> <span class="op">&lt;-</span> <span class="va">htmlOutput</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">html_nodes</span><span class="op">(</span><span class="st">".smallindent"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">html_text</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># collects download link</span></span>
<span><span class="va">reportLinks</span> <span class="op">&lt;-</span> <span class="va">htmlOutput</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">html_nodes</span><span class="op">(</span><span class="st">".smallindent &gt; a"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">html_attr</span><span class="op">(</span><span class="st">'href'</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># year and report match</span></span>
<span><span class="va">reportSources</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  years <span class="op">=</span> <span class="va">years</span>,</span>
<span>  report_link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">downloadString</span>, <span class="va">reportLinks</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># 1.2 Collecting Data ----</span></span>
<span><span class="va">downloadData</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">reportSourcesDF</span>, <span class="va">storageLocation</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">reportSourcesDF</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">reportYear</span> <span class="op">&lt;-</span> <span class="va">reportSourcesDF</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span><span class="op">$</span><span class="va">years</span></span>
<span>    <span class="va">report</span> <span class="op">&lt;-</span> <span class="va">reportSourcesDF</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span></span>
<span>    <span class="va">fileExt</span> <span class="op">&lt;-</span> <span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/fileutils.html" class="external-link">file_ext</a></span><span class="op">(</span><span class="va">report</span><span class="op">)</span></span>
<span>    <span class="va">outputLocation</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{storageLocation}/{reportYear}.csv"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># downloads and save file temporarily</span></span>
<span>    <span class="fu"><a href="https://httr.r-lib.org/reference/GET.html" class="external-link">GET</a></span><span class="op">(</span><span class="va">report</span><span class="op">$</span><span class="va">report_link</span>, <span class="fu"><a href="https://httr.r-lib.org/reference/write_disk.html" class="external-link">write_disk</a></span><span class="op">(</span></span>
<span>      <span class="va">yearlyReport</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="va">fileExt</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="co"># removes introductory paragraphs from the excel files</span></span>
<span>    <span class="va">yearlyReport</span> <span class="op">=</span> <span class="fu">read_excel</span><span class="op">(</span><span class="va">yearlyReport</span>, col_names <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>    <span class="va">yearlyReport</span> <span class="op">&lt;-</span> <span class="va">yearlyReport</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">yearlyReport</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span>    <span class="va">yearlyReport</span> <span class="op">&lt;-</span> <span class="va">yearlyReport</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">yearlyReport</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span>    <span class="va">yearlyReport</span> <span class="op">&lt;-</span> <span class="va">yearlyReport</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">yearlyReport</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span>    <span class="co"># promotes first full row as column names</span></span>
<span>    <span class="va">yearlyReport</span> <span class="op">&lt;-</span> <span class="va">yearlyReport</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">janitor</span><span class="fu">::</span><span class="fu">row_to_names</span><span class="op">(</span>row_number <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># writes back to the desired location</span></span>
<span>    <span class="va">yearlyReport</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu">write_excel_csv</span><span class="op">(</span><span class="va">outputLocation</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># populates a summary report with col names</span></span>
<span>    <span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">yearlyReport</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">cols</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;-</span> <span class="va">reportYear</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">cols</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># downloads all the files and saving them in the location provided in downloadData() as storageLocation argument.</span></span>
<span><span class="va">reportSourcesSummary</span> <span class="op">&lt;-</span> <span class="fu">downloadData</span><span class="op">(</span><span class="va">reportSources</span>, <span class="va">raw_data_loc</span><span class="op">)</span></span></code></pre></div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Arafath Hossain.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
